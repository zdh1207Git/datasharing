# 如何与统计学家共享数据
============

这是任何需要与统计学家或数据科学家共享数据的人的指南。我心目中的目标受众是：

* 需要统计学家或数据科学家为他们分析数据的合作者
* 寻求咨询建议的各个学科的学生或博士后
* 初级统计学学生，其工作是整理/清理/整理数据集

本指南的目标是提供一些有关共享数据的最佳方式的说明，以避免最常见的陷阱及从数据收集到数据分析的过渡中产生延迟的根源。 [Leek group](http://biostat.jhsph.edu/~jleek/) Leek集团与大量
合作者开展过合作，影响产出结果速度的第一来源是当数据到达Leek集团时的状态。根据我与其他统计学家的谈话，这几乎是普遍适用的。

我强烈感觉到统计学家应该能够处理他们到达的任何状态的数据。在数据分析的中，查看原始数据，了解处理流程中的步骤，并能够合并可变性的隐藏数据源很重要。另一方面，对于许多数据类型，处理步骤
都有详细记录和标准化，因此可以在请教统计学家之前执行将数据从原始形式转换为可直接分析形式的工作。这可以显着加快周转时间，因为统计学家无须首先完成所有预处理步骤。

你应该向统计学家提供什么
====================

为了促进最有效和及时的分析，您应该将以下信息传递给统计学家：

1. 原始数据。
2.一个[整洁的数据集](http://vita.had.co.nz/papers/tidy-data.pdf)
3. 描述整洁数据集中每个变量及其值的代码簿。
4. 步骤1到3执行过程的明确而准确的描述。

我们来看看你要传输的数据包的每个部分。


###原始数据

包含您有权访问的最原始形式的数据至关重要。这确保可以在整个工作流程中维护数据来源。下面是一些例子原始数据形式：

* 你的测量机吐出来的奇怪的[二进制文件](http://en.wikipedia.org/wiki/Binary_file) 
* 与您签约的公司发送给您的带有 10 个工作表的无格式 Excel 文件
* 您从 [Twitter API](https://twitter.com/twitterapi) 中获取的复杂 [JSON](http://en.wikipedia.org/wiki/JSON) 数据
* 您通过显微镜收集的手工输入数字

如果您符合以下条件，您就知道原始数据的格式是正确的：

1. 没有对数据运行软件
2. 没有修改任何数据值
3. 你没有从数据集中删除任何数据
4. 你没有以任何方式汇总数据

如果您对原始数据进行了任何修改，则它不是数据的原始形式。提交修改过的数据作为原始数据是减慢分析过程的一种常见的原因，因为分析师通常需要做一个对您的数据进行取证研究，
以找出原始数据看起来很奇怪的原因。 （还想象一下如果新数据到来会发生什么？）

### 整洁的数据集

[Hadley Wickham](http://had.co.nz/) 在 [此文档](http://vita.had.co.nz/papers/tidy-data. pdf)和 [此视频](http://vimeo.com/33727555)中阐述了整洁数据的一般原则。
虽然论文和视频都使用 [R](http://www.r-project.org/) 描述了整洁的数据，但原则更普遍适用：

1. 你测量的每个变量都应该在一列中
2. 该变量的每个不同观察值都应该在不同的行中
3. 每种“种类”的变量应该有一个表
4. 如果你有多个表，他们应该在表中包含一列，该列允许它们连接或合并

虽然这些是硬性规定，但还有许多其他事情可以使您的数据集更容易处理。首先是在每个数据表/电子表格的顶部包含一行，其中包含完整的行名称。因此，如果您在诊断时测量了患者的年龄，
则该列的标题应该命名为“AgeAtDiagnosis”，而不是诸如“ADx”或其他人可能难以理解的缩写。


这里是基因组学如何运作的一个例子。假设您收集了 20 个人的基因表达测量值[RNA 测序](http://en.wikipedia.org/wiki/RNA-Seq)。您还收集了关于患者的人口统计和临床信息，
包括他们的年龄、治疗和诊断。您将拥有一张包含临床/人口统计数据的表格/电子表格信息。它将有4列（患者 ID、年龄、治疗、诊断）和 21 行（一行带有变量名称，然后每一行代表一位患者）。
您还将拥有一份用于汇总基因组数据的电子表格。通常这种类型的数据基于每个基因子的计数水平进行总结。假设您有 100,000 个基因子，那么您将有一个表格/电子表格，它有 21 行（基因名称
一行，每位患者一行）和 100,001 列（患者ids一列，每种数据类型的一列）。

如果您在 Excel 中与协作者共享您的数据，则每个表格中的整洁数据应位于一个 Excel 文件中。他们不应有多个工作表，不应将宏应用于数据，也不应突出显示列/单元格。或者使用
[CSV](http://en.wikipedia.org/wiki/Comma-separated_values) 或 [TAB-delimited](http://en.wikipedia.org/wiki/Tab-separated_values) 格式的文本共享数据文件。 
（但请注意，将 CSV 文件读入 Excel 有时会导致无法重现的日期和时间变量处理。）

### 代码本

对于几乎任何数据集，您计算的测量值都需要比你能做到的描述更详细的描述，还不包括你偷偷摸摸塞进去的内容。
代码本包含此信息。它至少应包含：

1. 数据集中未包含在整洁数据中的变量信息（包括单位！）
2. 关于您所做的总结选择的信息
3. 关于您使用的实验研究设计的信息

在我们的基因组学示例中，分析师想知道每个的测量单位是什么，临床/人口统计学变量是什么（年龄、名称/剂量、诊断水平和异质性）。他们还想知道您如何挑选用于总结基因组数据的外显子
（UCSC/Ensembl 等）。他们还想知道有关您如何进行数据收集/研究设计的任何其他信息。例如，这些是走进诊所的前 20 名患者吗？他们是 20 位经过某些特征精心挑选的患者吗？比如年龄？
他们是否随机接受治疗？

此文档的常见格式是 Word 文件。它应该包括一个名为“研究设计”的部分，其中有一个完整的您如何收集数据的描述。有一个名为“代码手册”的部分描述了每个变量及其单位。

###如何编码变量

当您将变量放入电子表格时，您会遇到几个主要类别，具体取决于它们的 [数据类型](http://en.wikipedia.org/wiki/Statistical_data_type)：

1. 连续
2. 序数
3. 分类
4. 失踪
5. 审查

连续变量是在定量尺度上测量的任何东西，可以是任何小数。一个类似于以公斤为单位的体重的例子。 [序数数据](http://en.wikipedia.org/wiki/Ordinal_data) 是具有固定的小 (< 100) 级数但有序的数据。
例如，这可能选择为：差、一般、好的调查回复。 [分类数据](http://en.wikipedia.org/wiki/Categorical_variable) 是存在是多个类别，但它们没有排序。一个例子是性别：男性或女性。这种编码很有吸引力，
因为它是自我记录的。 [缺失数据](http://en.wikipedia.org/wiki/Missing_data) 是那些未被观察到的数据，你不知道内含的机制是什么。您应该将缺失值编码为“NA”。 [截尾数据]
(http://en.wikipedia.org/wiki/Censoring_\(statistics\)) 是你知道某种程度的缺失机制的数据。常见的例子是低于检测限的测量或失去随访的患者。当您没有数据时，它们也应编码为“NA”。但是你应该还向
您的整洁数据添加一个名为“VariableNameCensored”的新列，如果被审查，该列的值应为“TRUE”。如果不是，则为“False”。在代码手册中，您应该解释为什么缺少这些值。报告是绝对重要的。如果您知道某些数据
丢失的原因，请告知分析师。你也不应该 [impute](http://en.wikipedia.org/wiki/Imputation_\(statistics\))/make up/丢弃丢失的观察结果。

通常，尽量避免将分类或有序变量编码为数字。当您在整洁数据中输入性别值的数据应该是“男”或“女”。数据集中的序数值应该是“差”、“一般”和“好”，而不是 1、2、3。这将避免关于哪个方向效应发生的潜在混淆，
并有助于识别编码错误。

始终使用文本对有关您的观察的每条信息进行编码。例如，如果您在 Excel 中存储数据并使用彩色文本形式或单元格背景格式来指示有关观察的信息（“在实验 1 中观察到红色变量条目。”），则不会导出此信息
（并且将丢失！）当数据导出为原始文本时。每条数据都应编码为可以导出的实际文本。

###指令列表/脚本

您以前可能听说过这个，但是 [再现性在计算科学中很重要](http://www.sciencemag.org/content/334/6060/1226)。这意味着，当您提交论文时，审稿人和世界其他地方应该能够准确复制从原始数据到最终结果
的分析。如果你想提高效率，你很可能会执行在数据可以被认为是整洁之前的一些总结/数据分析步骤。

执行摘要时最理想的做法是创建一个计算机脚本（在“R”、“Python”或其他语言中）它将原始数据作为输入并生成您正在共享的整洁数据作为输出。您可以尝试运行您的脚本几次，看看代码是否产生相同的输出。

在许多情况下，收集数据的人有动力让统计人员将数据整理好以加快流程的合作。他们可能不知道如何用脚本语言编写代码。在这种情况下，您应该向统计学家提供一种叫做 
[伪代码](http://en.wikipedia.org/wiki/Pseudocode) 的东西。它应该看起来像：

1. 步骤 1 - 获取原始文件，运行 3.1.2 版本的汇总软件，参数 a=1, b=2, c=3
2. 步骤 2 - 为每个样本单独运行软件
3. 步骤 3 - 为每个样本取 outputfile.out 的第三列，即输出数据集中的对应行

您还应该包括有关您在哪个系统 (Mac/Windows/Linux) 上使用该软件以及您是否多次尝试以确认它给出了相同的结果。理想情况下，您将由同学/实验室伙伴运行此程序，确认他们可以获得与您相同的输出文件。


您应该从分析师那里得到什么
====================

当您提交经过适当整理的数据集时，它会显着减少统计人员的工作量。所以希望他们会很快回复你。但大多数细心的统计学家会检查你的数据，询问有关您执行的步骤，并尝试确认他们可以获得与您所做的相同的
整洁数据，至少到现场检查一下。

然后你应该期待统计学家：

1. 执行每个分析的分析脚本（不仅仅是指令）
2. 他们用来运行分析的确切计算机代码
3. 他们生成的所有输出文件/图形。

这是您将在补充材料中用于确定结果的重现性和精确度的信息。每个分析中的步骤应该清楚地解释，当你不明白分析师做了什么的时候，你应该提出问题。统计学家和科学家都有责任理解统计分析。如果没有统计学家
的代码，您可能无法执行准确的分析，但您应该能够解释为什么统计学家向实验室伙伴/您的主要研究人员执行每个步骤。

贡献者
====================

* [Jeff Leek](http://biostat.jhsph.edu/~jleek/) - 编写了初始版本。
* [L. Collado-Torres](http://bit.ly/LColladoTorres) - 修正错别字，添加链接。
* [Nick Reich](http://people.umass.edu/nick/) - 添加了将数据存储为文本的提示。
* [尼克霍顿](https://www.amherst.edu/people/facstaff/nhorton) - 次要措辞建议。
